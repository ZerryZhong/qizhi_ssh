var locale_validate=shterm.validate[locale];function AJAX_VALIDATE_SAME(f){var d=$.parseJSON($(f).attr("validate"));if(!d||!d.ajax){return true}var g=$.trim($(f).val()),a=_baseurl+"/include/ajax_validate.php",h=Number($(":hidden[name=id]").val()),e,c="val="+g+"&type="+d.ajax+"&id="+h;if(g==""){return true}else{}var b=false;$.ajax({type:"post",url:a,data:c,async:false,success:function(i){if(d.ajax=="ipaddr"){b=true;if(Number(i)<1){e=locale_validate.ipok;$(f).parent().find(".ok").show();$(f).parent().find(".attention").hide();$(f).parent().find(".error").hide()}else{b="ipexists";e=locale_validate.ipexist;$(f).parent().find(".ok").hide();$(f).parent().find(".attention").hide();$(f).parent().find(".error").text(e).show()}}else{if(i=="true"||i==h){e=locale_validate.ok;$(f).parent().find(".ok").show();$(f).parent().find(".attention").hide();$(f).parent().find(".error").hide();b=true}else{e=locale_validate.exists;$(f).parent().find(".ok").hide();$(f).parent().find(".attention").hide();$(f).parent().find(".error").text(e).show()}}},error:function(){$(f).parent().find(".ok").hide();$(f).parent().find(".attention").hide();$(f).parent().find(".error").text(locale_validate.error).show()}});return b}function FORM_VALIDATE_FOCUS(obj,submit_flag){var v_json,mark,val="",reg,res_foo;if(!submit_flag){$(obj).addClass("text-focus")}v_json=$(obj).attr("validate");if(v_json){v_json=$.parseJSON(v_json);val=$.trim($(obj).val());if(v_json.password||v_json.confirm_password){val=$(obj).val()}mark=false;$(obj).parent().find(".msg").show();if(v_json.foo&&!mark){res_foo=eval(""+v_json.foo+";");switch(res_foo.type){case".attention":$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".attention").text(res_foo.info).show();return false;case".error":$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(res_foo.info).show();return false;case".ok":if(!v_json.all){$(obj).parent().find(".error").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").show();return true}break;default:if(!v_json.all){$(obj).parent().find(".msg").hide();return true}}}if(submit_flag&&v_json.required&&val.length==0){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(v_json.title+locale_validate.none).show();return false}else{if(submit_flag&&!v_json.required&&val.length==0){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").hide();return true}}if(val.length==0){$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".attention").text(v_json.attention).show();mark=true}if(v_json.reg&&!mark){switch(v_json.reg){case"number":v_json.reg="^[0-9]+$";break;case"mobile":v_json.reg="^[0-9_+-]+$";break;case"quote":v_json.reg="^[^']+$";break;case"chinese":v_json.reg="^[\\\u0391-\\\uFFE5]+$";break;case"stamp":break}if(v_json.reg=="nobackslash"){reg=/[^\\]$/}else{if(v_json.reg=="email"){reg=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i}else{if(v_json.reg=="url"){reg=/^http[s]?:\/\/[a-zA-Z0-9_!~\/\*'().;?:@&=+$,%#-]+[\/]?$/}else{if(v_json.reg=="openurl"){reg=/^(http[s]?:\/\/.*[\/]?)|(about:blank)$/}else{reg=new RegExp(v_json.reg)}}}}if(!reg.test(val)){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(v_json.title+locale_validate.invalid).show();return false}}if(v_json.len&&!mark){if(val.length<v_json.len[0]||val.length>v_json.len[1]){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(sprintf(locale_validate.len,v_json.title,v_json.len[0],v_json.len[1])).show();return false}}if(v_json.ipaddr&&!mark){var res=IPADDR({ipaddr:val,scope:v_json.ipaddr});if(res!==true){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(res).show();return false}}if(v_json.scope&&!mark){if(Number(val)<v_json.scope[0]||Number(val)>v_json.scope[1]){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(sprintf(locale_validate.scope,v_json.title,v_json.scope[0],v_json.scope[1])).show();return false}}if((v_json.password||v_json.confirm_password)&&!mark){var attention_str="";if(v_json.password_type=="server_manual"){reg=/^[a-zA-Z0-9`~!@#\$%\^&\*\(\)\-=_\+\[\]\|\{\}:;'",.\?<>\\\/ ]+$/;attention_str=locale_validate.alpha_specialchars}else{reg=/^[a-zA-Z0-9`~!@#\$%\^&\*\(\)\-=_\+\[\]\|\{\}:;'",.\?<>]+$/;attention_str=locale_validate.alpha}if(!reg.test(val)){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(v_json.title+attention_str).show();return false}if(v_json.password_type=="server_manual"){reg=/[\\\/ ]+/;if(reg.test(val)&&v_json.specialchars_attention){$(obj).parent().find(".attention").text(locale_validate.specialchars).show();return true}}}if(v_json.confirm_password&&!mark){var passwd=$("#"+v_json.confirm_password).val();if(val!=passwd&&passwd.length>0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(locale_validate.passwd).show();return false}else{if(passwd.length==0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").show();$(obj).parent().find(".error").hide();$("#"+v_json.confirm_password).parent().find(".error").text(locale_validate.setpass).show();return false}}}if(!mark){$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".ok").show();return true}}return true}function FORM_VALIDATE_BLUR(obj){var v_json,mark,val="",reg;$(obj).removeClass("text-focus");v_json=$(obj).attr("validate");if(v_json){v_json=$.parseJSON(v_json);val=$.trim($(obj).val());if(v_json.password||v_json.confirm_password){val=$(obj).val()}mark=false;if(v_json.foo&&!mark){res_foo=eval(""+v_json.foo+";");switch(res_foo.type){case".attention":$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".attention").text(res_foo.info).show();return false;case".error":$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(res_foo.info).show();return false;case".ok":if(!v_json.all){$(obj).parent().find(".error").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").show();return true}break;default:if(!v_json.all){$(obj).parent().find(".msg").hide();return true}}}if(v_json.required&&!mark){if(!val||val.length==0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(v_json.title+locale_validate.none).show();mark=true}}else{if(val.length==0){$(obj).parent().find(".msg").hide();mark=true}}if(v_json.reg&&!mark){switch(v_json.reg){case"number":v_json.reg="^[0-9]+$";break;case"mobile":v_json.reg="^[0-9_+-]+$";break;case"quote":v_json.reg="^[^']+$";break;case"chinese":v_json.reg="^[\\\u0391-\\\uFFE5]+$";break;case"stamp":break}if(v_json.reg=="nobackslash"){reg=/[^\\]$/}else{if(v_json.reg=="email"){reg=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i}else{if(v_json.reg=="url"){reg=/^http[s]?:\/\/[a-zA-Z0-9_!~\/\*'().;?:@&=+$,%#-]+[\/]?$/}else{if(v_json.reg=="openurl"){reg=/^(http[s]?:\/\/.*[\/]?)|(about:blank)$/}else{reg=new RegExp(v_json.reg)}}}}if(!reg.test(val)){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(v_json.title+locale_validate.invalid).show();mark=true}}if(v_json.len&&!mark){if(val.length<v_json.len[0]||val.length>v_json.len[1]){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(sprintf(locale_validate.len,v_json.title,v_json.len[0],v_json.len[1])).show();mark=true}}if(v_json.scope&&!mark){if(Number(val)<v_json.scope[0]||Number(val)>v_json.scope[1]){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(sprintf(locale_validate.scope,v_json.title,v_json.scope[0],v_json.scope[1])).show();mark=true}}if(v_json.ipaddr&&!mark){var res=IPADDR({ipaddr:val,scope:v_json.ipaddr});if(res!==true){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(res).show();mark=true}}if((v_json.password||v_json.confirm_password)&&!mark){var attention_str="";if(v_json.password_type=="server_manual"){reg=/^[a-zA-Z0-9`~!@#\$%\^&\*\(\)\-=_\+\[\]\|\{\}:;'",.\?<>\\\/ ]+$/;attention_str=locale_validate.alpha_specialchars}else{reg=/^[a-zA-Z0-9`~!@#\$%\^&\*\(\)\-=_\+\[\]\|\{\}:;'",.\?<>]+$/;attention_str=locale_validate.alpha}if(!reg.test(val)){$(obj).parent().find(".ok").hide();$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").text(v_json.title+attention_str).show();return false}if(v_json.password_type=="server_manual"){reg=/[\\\/ ]+/;if(reg.test(val)&&v_json.specialchars_attention){$(obj).parent().find(".attention").text(locale_validate.specialchars).show();mark=true}}}if(v_json.confirm_password&&!mark){var passwd=$("#"+v_json.confirm_password).val();if(val!=passwd&&passwd.length>0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").hide();$(obj).parent().find(".error").text(locale_validate.passwd).show();mark=true}else{if(passwd.length==0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".ok").show();$(obj).parent().find(".error").hide();$("#"+v_json.confirm_password).parent().find(".error").text(locale_validate.setpass).show();mark=true}}}if(v_json.password&&v_json.password!==true&&!mark){var passwd=$("#"+v_json.password).val();if(val==passwd&&passwd.length>0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".ok").show();$("#"+v_json.password).parent().find(".attention").hide();$("#"+v_json.password).parent().find(".error").hide();$("#"+v_json.password).parent().find(".ok").show();mark=true}else{if(passwd.length==0){$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".ok").show();$("#"+v_json.password).parent().find(".attention").hide();$("#"+v_json.password).parent().find(".ok").hide();$("#"+v_json.password).parent().find(".error").text(locale_validate.pass2).show();mark=true}}}if(v_json.ajax&&!mark){mark=AJAX_VALIDATE_SAME(obj);if(mark=="ipexists"){mark=true}else{mark=!mark}}if(!mark){$(obj).parent().find(".attention").hide();$(obj).parent().find(".error").hide();$(obj).parent().find(".ok").show()}}}function FORM_FOCUS(){$(":text").focus(function(){FORM_VALIDATE_FOCUS(this)});$(":text").blur(function(){FORM_VALIDATE_BLUR(this)});$(":password").focus(function(){FORM_VALIDATE_FOCUS(this)});$(":password").blur(function(){FORM_VALIDATE_BLUR(this)});$("textarea").focus(function(){FORM_VALIDATE_FOCUS(this)});$("textarea").blur(function(){FORM_VALIDATE_BLUR(this)});$("select").change(function(){FORM_VALIDATE_FOCUS(this);$(this).removeClass("text-focus")})}function FORM_SUBMIT_VALIDATE(obj,formid,foo){$(obj).attr("disabled","disabled");if(_validate_switch=="1"&&_form_validate=="1"){var cnt=0,temp;$(":text:visible").each(function(){temp=FORM_VALIDATE_FOCUS(this,true);if(!temp){cnt++;var msg=$(this).parent().find(".msg_same");if(msg){msg.removeClass("warning").text("")}}else{temp=AJAX_VALIDATE_SAME(this,true);if(!temp){cnt++}}});$(":password:visible").each(function(){temp=FORM_VALIDATE_FOCUS(this,true);if(!temp){cnt++}});$("select:visible").each(function(){temp=FORM_VALIDATE_FOCUS(this,true);$(this).removeClass("text-focus");if(!temp){cnt++}});$("textarea:visible").each(function(){temp=FORM_VALIDATE_FOCUS(this,true);if(!temp){cnt++}});if(cnt){$(obj).removeAttr("disabled");return false}else{var res=true;if(foo){res=eval(""+foo+"")}if(res){document.getElementById(formid).submit()}else{$(obj).removeAttr("disabled")}}}else{document.getElementById(formid).submit()}}function NEXT_VALIDATE(){if(_validate_switch=="1"&&_form_validate=="1"){var b=0,a;$(":text:visible").each(function(){a=FORM_VALIDATE_FOCUS(this,true);if(!a){b++}});$(":password:visible").each(function(){a=FORM_VALIDATE_FOCUS(this,true);if(!a){b++}});$("select:visible").each(function(){a=FORM_VALIDATE_FOCUS(this,true);$(this).removeClass("text-focus");if(!a){b++}});$("textarea:visible").each(function(){a=FORM_VALIDATE_FOCUS(this,true);if(!a){b++}});if(b){return false}else{return true}}else{return true}}function IPADDR(a){var e,d,c,m,g,b,l;if(a.scope=="space"){e=/^((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))$/;d=/^(((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\s+)+((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))$/;if(e.test(a.ipaddr)){return true}if(d.test(a.ipaddr)){return true}}else{if(a.scope=="three"){m=a.ipaddr.split(",");for(var h=0,j=m.length;h<j;h++){e=/^((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))$/;d=/^((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))-((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))$/;c=/^((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}[\*]$/;if(!e.test(m[h])&&!d.test(m[h])&&!c.test(m[h])){return locale_validate.ip}if(d.test(m[h])){g=m[h].split("-");b=g[0].split(".");l=g[1].split(".");for(var f=0;f<4;f++){if(Number(b[f])<Number(l[f])){return true}if(Number(b[f])>Number(l[f])){return sprintf(locale_validate.ipscope,m[h])}}}}return true}else{e=/^((([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))\.){3}(([0-9]?[0-9])|(1[0-9]{2})|(2[0-4][0-9])|(25[0-5]))$/;if(e.test(a.ipaddr)){return true}}}return locale_validate.ip};